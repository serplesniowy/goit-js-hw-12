{"version":3,"file":"commonHelpers2.js","sources":["../src/01/images-01.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst API_KEY = '45072891-a2b62f681812c134104bf6075';\nconst API_URL = 'https://pixabay.com/api/';\nconst PER_PAGE = 40;\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\nlet shouldScrollOnLoadMore = false;\n\nfunction showLoader() {\n  const loader = document.querySelector('.loading');\n  if (loader) {\n    loader.style.display = 'flex';\n  }\n}\n\nfunction hideLoader() {\n  const loader = document.querySelector('.loading');\n  if (loader) {\n    loader.style.display = 'none';\n  }\n}\n\nfunction showLoadMoreButton() {\n  const loadMoreButton = document.querySelector('.load-more-button');\n  if (loadMoreButton) {\n    loadMoreButton.style.display = 'block';\n  }\n}\n\nfunction hideLoadMoreButton() {\n  const loadMoreButton = document.querySelector('.load-more-button');\n  if (loadMoreButton) {\n    loadMoreButton.style.display = 'none';\n  }\n}\n\nfunction showEndOfResultsMessage() {\n  iziToast.info({\n    title: 'End of Results',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'topRight',\n  });\n}\n\nasync function fetchImages(query, page = 1) {\n  try {\n    const response = await axios.get(API_URL, {\n      params: {\n        key: API_KEY,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: page,\n        per_page: PER_PAGE,\n      },\n    });\n\n    const { hits, totalHits: total } = response.data;\n    totalHits = total;\n\n    if (hits.length === 0) {\n      iziToast.error({\n        title: 'No results',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n      });\n      return [];\n    }\n\n    return hits;\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred while downloading the images. Try again!',\n      position: 'topRight',\n    });\n    console.error('Błąd pobierania danych:', error);\n    return [];\n  }\n}\n\nfunction renderImages(images) {\n  const gallery = document.getElementById('gallery');\n  if (!gallery) return;\n\n  images.forEach(image => {\n    const imgElement = document.createElement('a');\n    imgElement.href = image.largeImageURL;\n    imgElement.classList.add('gallery-item');\n\n    const imageTag = document.createElement('img');\n    imageTag.src = image.webformatURL;\n    imageTag.alt = image.tags;\n    imageTag.classList.add('gallery-image');\n\n    const infoDiv = document.createElement('div');\n    infoDiv.classList.add('image-info');\n    infoDiv.innerHTML = `\n      <div>\n        <span class=\"label\">Likes:</span>\n        <span>${image.likes}</span>\n      </div>\n      <div>\n        <span class=\"label\">Views:</span>\n        <span>${image.views}</span>\n      </div>\n      <div>\n        <span class=\"label\">Comments:</span>\n        <span>${image.comments}</span>\n      </div>\n      <div>\n        <span class=\"label\">Downloads:</span>\n        <span>${image.downloads}</span>\n      </div>\n    `;\n\n    imgElement.appendChild(imageTag);\n    imgElement.appendChild(infoDiv);\n    gallery.appendChild(imgElement);\n  });\n\n  lightbox.refresh();\n  console.log('shouldScrollOnLoadMore:', shouldScrollOnLoadMore); \n  if (shouldScrollOnLoadMore) {\n    setTimeout(smoothScrollToNewImages, 100);\n  }\n}\n\nconst lightbox = new SimpleLightbox('.gallery-item', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction smoothScrollToNewImages() {\n    const galleryItems = document.querySelectorAll('.gallery-item');\n    if (galleryItems.length > 0) {\n      const lastItem = galleryItems[galleryItems.length - 1];\n      const rect = lastItem.getBoundingClientRect();\n      const itemHeight = rect.height;\n  \n      window.scrollBy({\n        top: 2 * itemHeight,\n        behavior: 'smooth',\n      });\n    }\n  }\n\n  async function handleSearch(event) {\n    event.preventDefault();\n  \n    const query = document.getElementById('search-input').value.trim();\n    if (!query) return;\n  \n    currentQuery = query;\n    currentPage = 1;\n  \n    showLoader();\n    hideLoadMoreButton();\n    const images = await fetchImages(currentQuery, currentPage);\n    const gallery = document.getElementById('gallery');\n    gallery.innerHTML = '';\n    renderImages(images);\n    hideLoader();\n  \n    shouldScrollOnLoadMore = false;\n  \n    if (images.length === PER_PAGE) {\n      showLoadMoreButton();\n    } else {\n      hideLoadMoreButton();\n      showEndOfResultsMessage();\n    }\n  }\n\nasync function handleLoadMore() {\n    currentPage += 1;\n  \n    showLoader();\n    const images = await fetchImages(currentQuery, currentPage);\n  \n    if (currentPage * PER_PAGE >= totalHits) {\n      hideLoadMoreButton();\n      showEndOfResultsMessage();\n    } else {\n      \n      shouldScrollOnLoadMore = true;\n      \n      renderImages(images);\n      hideLoader();\n  \n      if ((currentPage - 1) * PER_PAGE + images.length < totalHits) {\n        showLoadMoreButton();\n      } else {\n        hideLoadMoreButton();\n        showEndOfResultsMessage();\n      }\n    }\n  }\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const searchForm = document.getElementById('search-form');\n  if (searchForm) {\n    searchForm.addEventListener('submit', handleSearch);\n  } else {\n    console.error('Element #search-form not found');\n  }\n\n  const loadMoreButton = document.querySelector('.load-more-button');\n  if (loadMoreButton) {\n    loadMoreButton.addEventListener('click', handleLoadMore);\n  } else {\n    console.error('Element .load-more-button not found');\n  }\n});\n"],"names":["API_KEY","API_URL","PER_PAGE","currentPage","currentQuery","totalHits","shouldScrollOnLoadMore","showLoader","loader","hideLoader","showLoadMoreButton","loadMoreButton","hideLoadMoreButton","showEndOfResultsMessage","iziToast","fetchImages","query","page","response","axios","hits","total","error","renderImages","images","gallery","image","imgElement","imageTag","infoDiv","lightbox","smoothScrollToNewImages","SimpleLightbox","galleryItems","itemHeight","handleSearch","event","handleLoadMore","searchForm"],"mappings":"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"}